--INSERT(C) , SELECT (R) , UPDATE(U) , DELETE(D)
--INSERT , UPDATE , DELETE 는 COMMIT과 ROLLBACK 이 동반됨.
SELECT * FROM DEPT;

CREATE TABLE TEMP_EMP AS SELECT * FROM EMP; --빈 껍데기 만드는법 조건을 맞지않게 설정
DROP TABLE TEMP_DEPT;
DROP TABLE TEMP_EMP;
SELECT * FROM TEMP_EMP;
--INSERT INTO  제약사항 NOT NULL
--문자,문자열,날짜일때 공백을 NULL 처리한다.
SELECT * FROM TEMP_DEPT;
INSERT INTO TEMP_DEPT 
VALUES (80,'FULLSTACK','');
COMMIT;
ROLLBACK;
INSERT INTO TEMP_EMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
VALUES(9997,'YEEUN','BOSS',NULL,TO_DATE('30-04-2024','DD-MM-YYYY'),6000,1200,20);

SELECT * FROM TEMP_EMP;

--수정 UPDATE 
SELECT * FROM TEMP_DEPT;

UPDATE TEMP_DEPT SET LOC ='BUSAN' WHERE LOC = 'BUSAN';
ROLLBACK;

UPDATE TEMP_DEPT SET LOC = 'GEOJE' , DNAME = 'AAA' WHERE DEPTNO = 80;


UPDATE TEMP_DEPT SET (DNAME,LOC) = (SELECT DNAME,LOC FROM TEMP_DEPT WHERE DEPTNO = 40) WHERE DEPTNO =80;


--삭제 DELETE  조건을 반드시 걸어야함. 
SELECT * FROM TEMP_EMP;
DELETE FROM TEMP_EMP WHERE JOB = 'MANAGER';
ROLLBACK;




---
CREATE TABLE TEMP_EMP AS SELECT * FROM EMP;
CREATE TABLE TEMP_DEPT AS SELECT * FROM DEPT;
CREATE TABLE TEMP_SALGRADE AS SELECT * FROM SALGRADE;
COMMIT;
--1
SELECT * FROM TEMP_DEPT;
SELECT * FROM TEMP_EMP TE INNER JOIN TEMP_DEPT TD ON TE.DEPTNO =TD.DEPTNO ;
INSERT INTO TEMP_DEPT (DEPTNO,DNAME,LOC)VALUES(50,'ORACLE','BUSAN');
INSERT INTO TEMP_DEPT (DEPTNO,DNAME,LOC)VALUES(60,'SQL','ILSAN');
INSERT INTO TEMP_DEPT (DEPTNO,DNAME,LOC)VALUES(70,'SELECT','INCHEON');
INSERT INTO TEMP_DEPT (DEPTNO,DNAME,LOC)VALUES(80,'DML','BUNDANG');
COMMIT;
--2
SELECT * FROM EMP;
CREATE TABLE CHAP10HW_EMP AS SELECT * FROM EMP;
DROP TABLE CHAP10HW_EMP;
COMMIT;
SELECT * FROM CHAP10HW_EMP;
INSERT INTO CHAP10HW_EMP VALUES(7201,'TEST_USER1','MANAGER',7788,'2024-01-02',4500,NULL,50);
INSERT INTO CHAP10HW_EMP VALUES(7202,'TEST_USER2','CLERK',7201,'2024-02-21',1800,NULL,50);
INSERT INTO CHAP10HW_EMP VALUES(7203,'TEST_USER3','ANALYST',7201,'2024-04-11',3400,NULL,60);
INSERT INTO CHAP10HW_EMP VALUES(7204,'TEST_USER4','SALESMAN',7201,'2024-05-31',2700,300,60);
INSERT INTO CHAP10HW_EMP VALUES(7205,'TEST_USER5','CLERK',7201,'2024-07-20',2600,NULL,70);
INSERT INTO CHAP10HW_EMP VALUES(7206,'TEST_USER6','CLERK',7201,'2024-09-08',2600,NULL,70);
INSERT INTO CHAP10HW_EMP VALUES(7207,'TEST_USER7','LECTURER',7201,'2024-10-28',2300,NULL,80);
INSERT INTO CHAP10HW_EMP VALUES(7208,'TEST_USER8','STUDENT',7201,'2024-03-09',1200,NULL,80);

INSERT INTO TEMP_EMP VALUES(7201,'TEST_USER1','MANAGER',7788,'2024-01-02',4500,NULL,50);
INSERT INTO TEMP_EMP VALUES(7202,'TEST_USER2','CLERK',7201,'2024-02-21',1800,NULL,50);
INSERT INTO TEMP_EMP VALUES(7203,'TEST_USER3','ANALYST',7201,'2024-04-11',3400,NULL,60);
INSERT INTO TEMP_EMP VALUES(7204,'TEST_USER4','SALESMAN',7201,'2024-05-31',2700,300,60);
INSERT INTO TEMP_EMP VALUES(7205,'TEST_USER5','CLERK',7201,'2024-07-20',2600,NULL,70);
INSERT INTO TEMP_EMP VALUES(7206,'TEST_USER6','CLERK',7201,'2024-09-08',2600,NULL,70);
INSERT INTO TEMP_EMP VALUES(7207,'TEST_USER7','LECTURER',7201,'2024-10-28',2300,NULL,80);
INSERT INTO TEMP_EMP VALUES(7208,'TEST_USER8','STUDENT',7201,'2024-03-09',1200,NULL,80);
SELECT * FROM TEMP_EMP;
ROLLBACK;
--3
--SELECT AVG(SAL) FROM TEMP_EMP WHERE DEPTNO = 50;
--SELECT * FROM TEMP_EMP WHERE SAL>(SELECT AVG(SAL) FROM TEMP_EMP WHERE DEPTNO = 50);
UPDATE TEMP_EMP SET DEPTNO=70 WHERE SAL>(SELECT AVG(SAL) FROM TEMP_EMP WHERE DEPTNO = 50);
SELECT * FROM TEMP_EMP;
COMMIT;
ROLLBACK;
--4
SELECT MIN(HIREDATE) FROM TEMP_EMP WHERE DEPTNO=60;
SELECT * FROM TEMP_EMP WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM TEMP_EMP WHERE DEPTNO=60);
UPDATE TEMP_EMP SET SAL=SAL*1.1,DEPTNO=80 WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM TEMP_EMP WHERE DEPTNO=60);
SELECT * FROM TEMP_EMP;
ROLLBACK;





